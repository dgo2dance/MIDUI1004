<!DOCTYPE html>
<!-- saved from url=(0042)http://wap.feekr.com/user/setInfo?id=37306 -->
<html lang="zh" class="hb-loaded"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="x5-orientation" content="portrait">
    <link rel="apple-touch-icon-precomposed" href="http://img.feekr.com/image/ios/feekr_57.png">
    <link rel="apple-touch-icon-precomposed" href="http://img.feekr.com/image/ios/feekr_72.png" sizes="72x72">
    <link rel="apple-touch-icon-precomposed" href="http://img.feekr.com/image/ios/feekr_76.png" sizes="76x76">
    <link rel="apple-touch-icon-precomposed" href="http://img.feekr.com/image/ios/feekr_114.png" sizes="114x114">
    <link rel="apple-touch-icon-precomposed" href="http://img.feekr.com/image/ios/feekr_120.png" sizes="120x120">
    <link rel="apple-touch-icon-precomposed" href="http://img.feekr.com/image/ios/feekr_152.png" sizes="152x152">
    <link rel="stylesheet" type="text/css" href="./css/index.css">    
    <script async="" src="./js/analytics.js"></script>
    <script type="text/javascript" src="./js/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" src="./js/template.js"></script>
    <script type="text/javascript" src="./js/config.js"></script>
    <script type="text/javascript" src="./js/utils.js"></script>
    <script type="text/javascript" src="./js/fastclick.js"></script>
    <script type="text/javascript" src="./js/swiper.jquery.min3.3.1.js"></script>
    <script type="text/javascript" src="./js/jquery.lazyload.min.js"></script>  
      <script src="./js/jweixin-1.0.0.js"></script>
    <title>觅对</title>
    </head>
<body huaban_collector_injected="true">
<div id="global-overlayer" class="global-overlayer" style="display: none;"></div>
<div id="global-loading" class="global-loading" style="display: none;">
    <div class="spinner">
        <div class="rect2"></div>
        <div class="rect3"></div>
        <div class="rect4"></div>
    </div>
    <p class="loading-txt">加载中...</p>
</div>
<div class="global-alert">
    <div class="alert-content"></div>
</div>
<script type="text/html" id="nav-tpl">
    <div class="nav">
        <nav class="nav-wrap table-mode">
            {{each nav as v i}}

            <div class="table-cell">
                {{if v.current}}
                <a class=" nav-menu nav-{{i}} v-link-active" href="{{v.path}}">
                    <span class="iconfont {{v.activeIcon}}"></span>
                    <span class="nav-name">{{v.name}}</span>
                </a>
                {{else}}
                <a class="nav-menu nav-{{i}}" href="{{v.path}}">
                    <span class="iconfont {{v.icon}}"></span>
                    <span class="nav-name">{{v.name}}</span>
                </a>
                {{/if}}
            </div>
            {{/each}}
        </nav>
    </div>
</script>
<script>
    $(function () {
        var configData = {
                nav: [
                    {
                        icon: 'icon-shouyenormal',
                        name: '首页',
                        activeIcon: 'icon-shouyepressed',
                        path: '/',
                        from: 'navindex'
                    },
                    {
                        icon: 'icon-jingxuannormal',
                        name: '精选',
                        activeIcon: 'icon-jingxuanpressed',
                        path: 'http://h5.feekr.com/new/catalog',
                        from: 'navselection'
                    },
                    {
                        icon: 'icon-gongluenormal',
                        name: '攻略',
                        activeIcon: 'icon-gonglvepressed',
                        path: '/guide/strategy',
                        from: 'navguide'
                    },
                    {
                        icon: 'icon-wodenormal',
                        name: '我的',
                        activeIcon: 'icon-wodepressed',
                        path: '/user',
                        from: 'navmypage'
                    }
                ]
            },
            isNav = false,
            from;
        configData.nav = configData.nav.map(function (v, i) {
            if (location.pathname == v.path) {
                v.current = true;
                isNav = true;
            }
            return v;
        });

        if (isNav) {

            from = configData.nav.filter(function (val, idx) {
                if(val.current) {
                    return val.from
                }
            });

            configData.nav = configData.nav.map(function (v, i) {
                v.path = v.path + '?pv_from=' + from[0].from + '';
                return v;
            });

            $('body').append(template('nav-tpl', configData))
        }

    })
</script>
<div class="wrap edit-mode myset-wrap user-wrap">
    <div class="inner-wrap">
        <header class="back-title user-header">
            <span>个人设置</span>
            <a href="http://wap.feekr.com/user" class="iconfont icon-fanhui"></a>
        </header>
        <div class="set-wrap"><div class="upload-wrap">
        <div class="setting-avatar-wrap">
            <form onsubmit="return false" id="upload-form">
            <input id="upload-avatar" type="file" accept="image/jpeg, image/png, image/jpg">
            
            <img src="./06.Feekr_编辑个人资料_files/02282179c6b328d3f9ff57a758f1c8730bb5c6.jpg!180X180" id="avatar">
            
            </form>
        </div>
        <p class="edit-avatar">点击图片编辑头像</p>
    </div>
    <section class="item">
        <div class="tips-title"><span class="iconfont icon-wodenormal"></span>昵称</div>
        <input class="input-info" placeholder="输入昵称（必填）" data-name="nickname" maxlength="30" value="hah">
    </section>
    <section class="item">
        <div class="tips-title"><span class="iconfont icon-gongwenbao"></span>职业</div>
        <input class="input-info" placeholder="输入职业" maxlength="30" data-name="profession" value="">
    </section>
    <section class="item">
        <div class="tips-title"><span class="iconfont icon-huatong"></span>个人宣言</div>
        <textarea class="input-info" placeholder="输入个人宣言" maxlength="300" data-name="aboutme" rows="4"></textarea>
    </section></div>
        <a href="http://wap.feekr.com/user/setInfo?id=37306" class="submit-btn">提交</a>
    </div>
</div>


    <!--数据统计-->
    <div style="display:none;">
        <script async="async" src="./06.Feekr_编辑个人资料_files/stat.php" language="JavaScript"></script>
        <script async="async">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-74126045-1', 'auto');
            ga('send', 'pageview');
        </script>
    </div>


<script type="text/html" id="setting-tpl">
    <div class="upload-wrap">
        <div class="setting-avatar-wrap">
            <form onsubmit="return false" id="upload-form">
            <input id="upload-avatar" type="file" accept="image/jpeg, image/png, image/jpg"/>
            {{if avatarUrl}}
            <img src="{{avatarDomain}}{{avatarUrl}}!180X180" id="avatar">
            {{else}}
            <img src="http://res.ifeekr.com/wap/avatar/fxb-avatar-180X180.jpg" id="avatar">
            {{/if}}
            </form>
        </div>
        <p class="edit-avatar">点击图片编辑头像</p>
    </div>
    <section class="item">
        <div class="tips-title"><span class="iconfont icon-wodenormal"></span>昵称</div>
        <input class="input-info" placeholder="输入昵称（必填）" data-name="nickname" maxlength="30"
               value="{{nickname}}">
    </section>
    <section class="item">
        <div class="tips-title"><span class="iconfont icon-gongwenbao"></span>职业</div>
        <input class="input-info" placeholder="输入职业" maxlength="30" data-name="profession"
               value="{{profession}}">
    </section>
    <section class="item">
        <div class="tips-title"><span class="iconfont icon-huatong"></span>个人宣言</div>
        <textarea class="input-info" placeholder="输入个人宣言" maxlength="300" data-name="aboutme" rows="4">{{aboutme}}</textarea>
    </section>
</script>
<script>
    $(function () {
        var tpl,
            container = $('.set-wrap'),
            setting = {};

        $.getAjax({
            url: api.userHome,
            data: {
                authUid: $.getCookie('uid')
            }
        }, function (res) {
            var data = res;
            tpl = template('setting-tpl', data.result.user);
            setting.avatarUrl = data.result.user.avatarUrl || '';
            container.html(tpl);

            //  ajax上传图片
            $('#upload-avatar').uploadPic({
                spaceName: 'photo02',
                form: $('#upload-form'),
                minWidth: 200, //最小图片宽度
                minHeight: 200 //最小图片高度
            }, function(res) {
                setting.avatarUrl = res.url;
                $('#avatar').attr('src', res.domain + res.url + '!180X180');
            });
        });

        $(document).on('click', '.submit-btn', function (e) {
            e.preventDefault();
            $('.input-info').each(function (i, v) {
                var name = $(this).data('name');
                setting[name] = $.trim($(this).val());
            });

            setting.authUid = $.getCookie('uid');

            if(!setting.nickname) {
                $.alert('请填写昵称!');
            } else if(!setting.avatarUrl) {
                $.alert('上传头像!');
            } else {
                $.getAjax({
                    url: api.submitMySet,
                    data: setting,
                    type: 'POST',
                    beforeSend: function () {
                        $.loading({
                            text: "提交中..."
                        });
                    }
                }, function (res) {
                    if (res.result.operation == 1) {
                        $.alert('设置成功');
                        setTimeout(function() {
                            location.href = '/user';
                        }, 800)
                    }
                });
            }
        });


    });
</script>

</body></html>